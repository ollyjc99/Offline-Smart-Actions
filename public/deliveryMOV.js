function runAction(S){const{data:{record:{Pricebook2Id:V},record:g,related:{Account:[P],OrderItem:r,Product2:x,PricebookEntry:Q,aforza__Inventory__c:[w]}},data:i}=S;if(g.Type!="YDEV"){let b=function(e){e.ProductCode=="000000019000000031"?(m=e.Id,u=e["MOV_"+o+"__c"]):e.ProductCode=="000000019000000034"&&(A=e.Id,c=e["MOV_"+o+"__c"])},p=function(e){e.Pricebook2Id==V&&(e.Product2Id==m?(s=e,e["MOV_"+o+"__c"]&&(u=e["MOV_"+o+"__c"])):e.Product2Id==A&&(f=e,e["MOV_"+o+"__c"]&&(c=e["MOV_"+o+"__c"])))},M=function(e){e.Quantity&&e.UnitPrice&&e.aforza__Type__c!="Tax"&&!(e.PricebookEntryId==s.Id||e.PricebookEntryId==f.Id)&&(D+=e.UnitPrice*e.Quantity)},W=function(e){return new Date(e.setDate(e.getDate()+1))},h=function(e){return dateString=e.toISOString().substring(0,10),Object.keys(T).includes(dateString)?!T[dateString].some(t=>["All",w.Name].includes(t)):!0},v=function(e){let t;for(let _ in r)if(r[_].PricebookEntryId==e.Id){t=_;break}t?r[t].Quantity!=1&&(r[t].Quantity=1,n.orderChanged=!0):(r.push({Product2Id:e.Product2Id,PricebookEntryId:e.Id,Quantity:1,UnitPrice:0,aforza__Type__c:"Product"}),n.orderChanged=!0,n.reprice=!0)},y=function(e){let t;for(let _ in r)if(r[_].PricebookEntryId==e.Id){t=_;break}t&&(r.splice(t,1),n.orderChanged=!0)};var N=b,R=p,U=M,j=W,B=h,F=v,G=y;let m,u,s,A,c,f;const T={"2023-04-07":["All"],"2023-12-25":["All"],"2023-12-08":["All"],"2023-12-01":["All"],"2023-11-01":["All"],"2023-10-05":["All"],"2023-08-15":["All"],"2023-06-10":["All"],"2023-06-08":["All"],"2023-04-25":["All","Warehouse - Alcains"],"2023-05-01":["All"],"2023-10-22":["Warehouse - Gr\xE2ndola"],"2023-05-22":["Warehouse - Leiria"],"2023-06-13":["Warehouse - Camarate"],"2023-05-23":["Warehouse - Portalegre"],"2023-06-24":["Warehouse - Porto"],"2023-06-29":["Warehouse - Set\xFAbal","Warehouse - \xC9vora","Warehouse - Bombarral"],"2023-09-03":["Warehouse - Algoz"],"2023-05-18":["Warehouse - Beja"],"2023-07-04":["Warehouse - Coimbra"],"2023-09-07":["Warehouse - Faro"]};let D=0,n={orderChanged:!1,reprice:!1},l,o=P.Customer_Segment__c;(!o||o=="99")&&(o="06"),x.forEach(b),Q.forEach(p),m&&!u&&(u=0),A&&!c&&(c=0),r.forEach(M);let a,I,d,k,C=g.EndDate,O=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],E=P.Delivery_Day__c.split(";");if(C)a=new Date(C),d=O[a.getDay()],h(a)||["Saturday","Sunday"].includes(d)||(k=!0);else{for(a=W(new Date),d=O[a.getDay()],I=h(a)&&E.includes(d);!I;)a=W(a),d=O[a.getDay()],I=h(a)&&E.includes(d);g.EndDate=a.toISOString().substring(0,10)}var z=E.includes(d)||["PT16","PT17","PT25"].includes(P.Typology__c);z?(y(f),D>=u?(l="A cesta excede o limite de entrega padr\xE3o, sem custo",y(s)):(l="A cesta n\xE3o atende ao limite de entrega padr\xE3o, produto de entrega adicionado",v(s))):(y(s),D>=c?(l="A cesta excede o limite fora da rota, sem custo",y(f)):(l="A cesta n\xE3o atende ao limite fora da rota, produto de entrega adicionado",v(f))),n.orderChanged?(i.updateDeviceData={Order:!0,OrderItem:!0},i.reprice=n.reprice):(i.updateDeviceData=!1,i.reprice=!1),k?i.message=l+`

Aviso, a data selecionada para entrega \xE9 um feriado ou um fim de semana \u2757`:i.message=l+`

Nova data de entrega: ${g.EndDate}`}else i.message="Nenhum valor m\xEDnimo de pedido para o tipo de pedido de devolu\xE7\xE3o \u2714";return S}
