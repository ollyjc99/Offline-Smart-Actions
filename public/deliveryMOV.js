function runAction(S){const{data:{record:{Pricebook2Id:M},record:y,related:{Account:[P],OrderItem:t,Product2:Q,PricebookEntry:V,aforza__Inventory__c:[w]}},data:o}=S;if(y.Type!="YDEV"){let p=function(e){e.ProductCode=="000000019000000031"?m=e.Id:e.ProductCode=="000000019000000034"&&(A=e.Id)},b=function(e){e.Pricebook2Id==M&&(e.Product2Id==m?(l=e,e["MOV_"+i+"__c"]&&(g=e["MOV_"+i+"__c"])):e.Product2Id==A&&(s=e,e["MOV_"+i+"__c"]&&(_=e["MOV_"+i+"__c"])))},x=function(e){e.Quantity&&e.UnitPrice&&e.aforza__Type__c!="Tax"&&!(e.PricebookEntryId==l.Id||e.PricebookEntryId==s.Id)&&(D+=e.UnitPrice*e.Quantity)},v=function(e){return new Date(e.setDate(e.getDate()+1))},h=function(e){return dateString=e.toISOString().substring(0,10),Object.keys(T).includes(dateString)?!T[dateString].some(r=>["All",w.Name].includes(r)):!0},O=function(e){let r;for(let f in t)if(t[f].PricebookEntryId==e.Id){r=f;break}r?t[r].Quantity!=1&&(t[r].Quantity=1,d.orderChanged=!0):(t.push({Product2Id:e.Product2Id,PricebookEntryId:e.Id,Quantity:1,UnitPrice:0,aforza__Type__c:"Product"}),d.orderChanged=!0,d.reprice=!0)},c=function(e){let r;for(let f in t)if(t[f].PricebookEntryId==e.Id){r=f;break}r&&(t.splice(r,1),d.orderChanged=!0)};var N=p,F=b,R=x,U=v,j=h,G=O,B=c;let m,g,l,A,_,s;const T={"2023-04-07":["All"],"2023-12-25":["All"],"2023-12-08":["All"],"2023-12-01":["All"],"2023-11-01":["All"],"2023-10-05":["All"],"2023-08-15":["All"],"2023-06-10":["All"],"2023-06-08":["All"],"2023-04-25":["All","Warehouse - Alcains"],"2023-05-01":["All"],"2023-10-22":["Warehouse - Gr\xE2ndola"],"2023-05-22":["Warehouse - Leiria"],"2023-06-13":["Warehouse - Camarate"],"2023-05-23":["Warehouse - Portalegre"],"2023-06-24":["Warehouse - Porto"],"2023-06-29":["Warehouse - Set\xFAbal","Warehouse - \xC9vora","Warehouse - Bombarral"],"2023-09-03":["Warehouse - Algoz"],"2023-05-18":["Warehouse - Beja"],"2023-07-04":["Warehouse - Coimbra"],"2023-09-07":["Warehouse - Faro"]};let D=0,d={orderChanged:!1,reprice:!1},u,i=P.Customer_Segment__c;(!i||i=="99")&&(i="06"),Q.forEach(p),V.forEach(b),m&&!g&&(g=0),A&&!_&&(_=0),t.forEach(x);let a,I,n,k,C=y.EndDate,E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],W=P.Delivery_Day__c.split(";");if(C)a=new Date(C),n=E[a.getDay()],h(a)||["Saturday","Sunday"].includes(n)||(k=!0);else{for(a=v(new Date),n=E[a.getDay()],I=h(a)&&W.includes(n);!I;)a=v(a),n=E[a.getDay()],I=h(a)&&W.includes(n);y.EndDate=a.toISOString().substring(0,10),d.orderChanged=!0}var z=W.includes(n)||["PT16","PT17","PT25"].includes(P.Typology__c);z?(c(s),D>=g?(u="A cesta excede o limite de entrega padr\xE3o, sem custo",c(l)):(u="A cesta n\xE3o atende ao limite de entrega padr\xE3o, produto de entrega adicionado",O(l))):(c(l),D>=_?(u="A cesta excede o limite fora da rota, sem custo",c(s)):(u="A cesta n\xE3o atende ao limite fora da rota, produto de entrega adicionado",O(s))),d.orderChanged?(o.updateDeviceData={Order:!0,OrderItem:!0},o.reprice=d.reprice):(o.updateDeviceData=!1,o.reprice=!1),k?o.message=u+`

Aviso, a data selecionada para entrega \xE9 um feriado ou um fim de semana \u2757`:o.message=u+`

Nova data de entrega: ${y.EndDate}`}else o.message="Nenhum valor m\xEDnimo de pedido para o tipo de pedido de devolu\xE7\xE3o \u2714";return S}
