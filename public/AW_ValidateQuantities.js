function runAction(i){const{data:{record:d,related:{Account:[a],Product2:I,OrderItem:l,aforza__Outlet_Asset__c:h}},data:p}=i,T="0122z000002QGJyAAO",g="0123L000000RQhRQAW",P="",R="0123L000000RQhQQAW",O="0123L000000c7uDQAQ",D="",w="0123L000000RQhQQAW",E="0123L000000bxrXQAQ",M="",S="0122z000002dp2PAAQ",W="0123L000000RoylQAC",z="",Q=new Set([T,g,P]),y=new Set([R,O,D]),_=new Set([w,E,M]),f=new Set([S,W,z]);if(!new Set(["Product Order","Sample Order"]).has(d.Type)||!new Set([...Q,...y,..._,...f]).has(a.RecordTypeId))return i;const m=[],L=new Set(l.map(e=>e.Product2Id)),c=new Map;I.forEach(e=>{L.has(e.Id)&&!new Set(["Tax","Promotion","Discount"]).has(e.Name)&&c.set(e.Id,e)});const C=l.filter(e=>c.has(e.Product2Id)),u=x(C);u.get("Product").length&&u.get("Product").forEach(e=>{Y(e)}),u.get("Outlet Asset").length&&N(u.get("Outlet Asset")),m.length?(p.message=`Einige Mengen wurden angepasst, um die Grenzwerte einzuhalten:
`,m.forEach(e=>{p.message+=`
 \u2022 ${e.Name}: ${e.Difference}`})):p.message="Mengen best\xE4tigt \u2713";function x(e){let r=new Map([["Product",[]],["Outlet Asset",[]]]);return e.forEach(t=>{let n=c.get(t.Product2Id);d.Type=="Product Order"&&Q.has(a.RecordTypeId)&&r.get("Product").push(t),(d.Type=="Sample Order"&&new Set([...y,_]).has(a.RecordTypeId)&&n.AW_Is_Restricted_Drug__c||d.Type=="Product Order"&&f.has(a.RecordTypeId))&&r.get("Outlet Asset").push(t)}),r}function N(e){const r=new Map;e.forEach(t=>{let n=d.AccountId+"-"+t.Product2Id;r.has(n)?r.get(n).push(t):r.set(n,[t])}),h.forEach(t=>{const n=t.aforza__Account__c+"-"+t.aforza__Product__c;if(!r.has(n))return;const o=r.get(n),s=U(t,a.AW_Country__c);o.forEach(F=>{V(t,F,s)})})}function U(e,r){let t,n=c.get(e.aforza__Product__c);return new Set([...y,_]).has(a.RecordTypeId)?t=n["AW_Doctor_Limit_"+r+"__c"]:f.has(a.RecordTypeId)&&(t=n.AW_FA_Yearly_Limit__c),t}function V(e,r,t){let n=e.AW_Yearly_Quantity__c!=null?e.AW_Yearly_Quantity__c:0,o=t-n,s=r.Quantity;r.Quantity=s+n<t?s:o>0?o:0,e.AW_Yearly_Quantity__c+=r.Quantity,s!=r.Quantity&&A(s,r)}function Y(e){let r=c.get(e.Product2Id).DRWO_Minimum_Quantity__c,t=c.get(e.Product2Id).DRWO_Maximum_Quantity__c,n=e.Quantity;e.Quantity=n<r?r:n>t?t:n,n!=e.Quantity&&A(n,e)}function A(e,r){let t=r.Quantity-e;m.push({Name:c.get(r.Product2Id).Name,Difference:t<0?t:"+"+t})}return i}
