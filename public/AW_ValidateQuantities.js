function runAction(o){const{data:{record:d,related:{Account:[n],Product2:f,OrderItem:s,aforza__Outlet_Asset__c:h}},data:O}=o,y="0122z000002QGJyAAO",p="0123L000000RQhQQAW",l="0122z000002dp2PAAQ";if(!new Set(["Product Order","Sample Order"]).has(d.Type)&&!new Set([y,p,l]).has(n.RecordTypeId)&&!new Set(["DE","AT","CH"]).has(n.AW_Country__c))return o;let T=!1;const Q=new Set(s.map(e=>e.Product2Id)),u=new Map;f.forEach(e=>{Q.has(e.Id)&&!new Set(["Tax","Promotion","Discount"]).has(e.Name)&&u.set(e.Id,e)});const _=g(s);_.get("Pharmacies")&&A(_.get("Pharmacies")),_.get("Individual")&&P(_.get("Individual"));function g(e){const a=new Map([["Pharmacies",[]],["Individual",[]]]);return e.forEach(t=>{let r=u.get(t.Product2Id);d.Type=="Product Order"&&n.recordType==y&&r.AW_Is_Restricted_Drug__c&&a.get("Pharmacies").push(t),(d.Type=="Product Order"&&n.recordType==l||d.Type=="Sample Order"&&n.recordType==p)&&a.get("Individual").push(t)}),a}function P(e){const a=new Map(e.map(t=>[t.accountId+"-"+t.Product2Id,[]]));e.forEach(t=>{let r=t.Order.accountId+"-"+t.Product2Id;a.get(r).add(t)}),h.forEach(t=>{let r=t.aforza__Account__c+t.aforza__Product__c;if(!a.has(r))return;let c;d.Type=="Sample Order"?c=u.get(t.aforza__Product__c).get("AW_Doctor_Limit_"+d.AW_Country__c+"__c"):c=t.AW_FA_Yearly_Limit__c,a.get(r).forEach(i=>{let m=t.AW_Yearly_Quantity__c!=null?t.AW_Yearly_Quantity__c:0,I=c-m;i.Quantity=i.Quantity+m<c?i.Quantity:I>0?I:0,t.AW_Yearly_Quantity__c+=i.Quantity})})}function A(e){let a=u.get(e.Product2Id).DRWO_Minimum_Quantity__c,t=u.get(e.Product2Id).DRWO_Maximum_Quantity__c,r=e.Quantity,c;c=r<a?a:r>t?t:r,e.Quantity=c}return o}
